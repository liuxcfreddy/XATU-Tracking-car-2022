C51 COMPILER V9.54   MAIN                                                                  09/26/2022 20:05:51 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\filegame\keil\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          /*È©±Âä®Ê®°Âùó‰ª£Á†ÅÁßªÊ§çËá™ÂîêÊù∞Â≠¶Èïø*/
   2          //#include "reg52.h"
   3          #include "intrins.h"
   4          #include "stc89c5xrc.h"
   5          /********‰ª•‰∏ã‰∏∫ÂèÇÊï∞‰∏éÁéØÂ¢ÉÂèòÈáèÂå∫********/
   6          unsigned int path;      //Á∫¢Â§ñÂØπÁÆ°ÂèçÈ¶àÁöÑÁéØÂ¢ÉÂèòÈáè
   7          unsigned int power; //P1Âè£ËØªÂèñÂ∏∏Èáè
   8          unsigned int pow;       //ÁîµÊú∫È©±Âä®ÂäõÂ∫¶ÁöÑË∞ÉËäÇ
   9          unsigned int pos;       //ËàµÊú∫ËΩ¨ÂêëÁ≠âÁ∫ßË∞ÉËäÇ
  10          unsigned int i=0;       //ËΩ®ÈÅì‰∏¢Â§±ÂèÇÊï∞(ÂΩìËΩ®ÈÅì‰∏¢Â§±Âà∞‰∏ÄÂÆöÁöÑÊó∂Èó¥ÂêéÂêØÂä®ÂÄíËΩ¶Á®ãÂ∫è)
  11          sbit  Car_Servo=P2^0;               // ËàµÊú∫pwmÊéßÂà∂
  12          
  13          void Delay(unsigned char time)          //@12.000MHz
  14          {
  15   1              unsigned char T=0;
  16   1              while(T==time)
  17   1              {
  18   2              unsigned char i, j, k;
  19   2      
  20   2              _nop_();
  21   2              _nop_();
  22   2              i = 5;
  23   2              j = 144;
  24   2              k = 71;
  25   2              do
  26   2              {
  27   3                      do
  28   3                      {
  29   4                              while (--k);
  30   4                      } while (--j);
  31   3              } while (--i);
  32   2              T++;
  33   2              }
  34   1      }
  35          
  36          unsigned int Servo0PwmDuty=1500;        //PWMËÑâÂÜ≤ÂÆΩÂ∫¶   1.5msËÑâÂÜ≤ÂÆΩÂ∫¶  ‰∏∫ËàµÊú∫Ê≠£‰∏≠‰ΩçÁΩÆ
  37          
  38          /***********************************************************
  39          * Âêç    Áß∞ÔºöInitTimer0()
  40          * Âäü    ËÉΩÔºöËàµÊú∫Êó∂Èíü0ÂàùÂßãÂåñ
  41          * ÂÖ•Âè£ÂèÇÊï∞ÔºöÊó†
  42          * Âá∫Âè£ÂèÇÊï∞ÔºöÊó†
  43          * ËØ¥    ÊòéÔºö12MÊô∂ÊåØÔºå12ÂàÜÈ¢ëÔºåÊâÄ‰ª•ËÆ°Êï∞Âô®ÊØèÈÄíÂ¢û‰∏Ä‰∏™Êï∞Â∞±ÊòØ1ÂæÆÁßíÔºåÂÆåÂÖ®Êª°Ë∂≥ËàµÊú∫Ê
             -éßÂà∂ÁöÑÁ≤æÂ∫¶Ë¶ÅÊ±Ç
  44                                  Âõ†‰∏∫ÂÆöÊó∂Âô®ÊòØTH0ÔºåTL0ÈÉΩË¶ÅÂÖ®ÈÉ®ËÆ°Êï∞Âà∞0xFFÂêéÂú®ËÆ°1‰∏™Êï∞Â∞±‰ºö‰∫ßÁîü‰∏≠Êñ≠ÔºåÊâÄ‰ª•Ë¶ÅÊÉ≥‰∫
             -ßÁîü
  45                                  xÊØ´ÁßíÁöÑ‰∏≠Êñ≠ÔºåÈÇ£‰πàTH0ÔºåTL0Â∞±Â∫îËØ•ËµãÂÄºÔºà0xFFFF-xÔºâ ‰ªéËøô‰∏™ÂÄºÂºÄÂßãËÆ°Êï∞‰∫ßÁîüÂÆöÊó∂‰∏≠
             -Êñ≠
  46          /**********************************************************/
  47          void InitTimer0(void)           //20ms
  48          {
  49   1          TMOD &= 0xF0;               //ËÆæÁΩÆÂÆöÊó∂Âô®Ê®°Âºè
  50   1          TMOD |= 0x01;               //ËÆæÁΩÆÂÆöÊó∂Âô®Ê®°Âºè
  51   1          TL0 = 0xE0;                 //ËÆæÁΩÆÂÆöÊó∂ÂàùÂÄº
C51 COMPILER V9.54   MAIN                                                                  09/26/2022 20:05:51 PAGE 2   

  52   1          TH0 = 0xB1;                 //ËÆæÁΩÆÂÆöÊó∂ÂàùÂÄº
  53   1          TF0 = 0;                    //Ê∏ÖÈô§TF0Ê†áÂøó
  54   1          TR0 = 1;                    //ÂÆöÊó∂Âô®0ÂºÄÂßãËÆ°Êó∂
  55   1          ET0 = 1;                    //ÂºÄÂÆöÊó∂Âô®0‰∏≠Êñ≠
  56   1          EA = 1;             //ÂºÄÊÄª‰∏≠Êñ≠
  57   1      }
  58          void Car_Servo_Init()   //ËàµÊú∫ÂàùÂßãÂåñ
  59          {
  60   1          InitTimer0();
  61   1      }
  62          
  63          /***********************************************************
  64          * Âêç    Áß∞ÔºöTimer0Value(uint16 pwm)
  65          * Âäü    ËÉΩÔºöÁªôÂÆöÊó∂Âô®0ËÆ°Êï∞Âô®ËµãÂÄº‰∫ßÁîüÂÆöÊó∂‰∏≠Êñ≠
  66          * ÂÖ•Âè£ÂèÇÊï∞Ôºöpwm            ÊéßÂà∂ËàµÊú∫ÁöÑPWMËÑâÂÜ≤ÂÆΩÂ∫¶ÂÄºÔºàËåÉÂõ¥Ôºö500~2500Ôºâ
  67          * Âá∫Âè£ÂèÇÊï∞ÔºöÊó†
  68          * ËØ¥    ÊòéÔºö12MÊô∂ÊåØÔºå12ÂàÜÈ¢ëÔºåÊâÄ‰ª•ËÆ°Êï∞Âô®ÊØèÈÄíÂ¢û‰∏Ä‰∏™Êï∞Â∞±ÊòØ1ÂæÆÁßíÔºåÂÆåÂÖ®Êª°Ë∂≥ËàµÊú∫Ê
             -éßÂà∂ÁöÑÁ≤æÂ∫¶Ë¶ÅÊ±Ç
  69                                  Âõ†‰∏∫ÂÆöÊó∂Âô®ÊòØTH0ÔºåTL0ÈÉΩË¶ÅÂÖ®ÈÉ®ËÆ°Êï∞Âà∞0xFFÂêéÂú®ËÆ°1‰∏™Êï∞Â∞±‰ºö‰∫ßÁîü‰∏≠Êñ≠ÔºåÊâÄ‰ª•Ë¶ÅÊÉ≥‰∫
             -ßÁîü
  70                                  pwmÊØ´ÁßíÁöÑ‰∏≠Êñ≠ÔºåÈÇ£‰πàTH0ÔºåTL0Â∞±Â∫îËØ•ËµãÂÄºÔºà0xFFFF-pwmÔºâ     ‰ªéËøô‰∏™ÂÄºÂºÄÂßãËÆ°Êï∞‰∫ßÁîüÂÆöÊó
             -∂‰∏≠Êñ≠
  71          /**********************************************************/
  72          void Timer0Value(unsigned int pwm)
  73          {
  74   1          unsigned int value;
  75   1          value=0xffff-pwm;
  76   1          TR0 = 0;
  77   1          TL0=value;                  //16‰ΩçÊï∞ÊçÆÁªô8‰ΩçÊï∞ÊçÆËµãÂÄºÈªòËÆ§Â∞Ü16‰ΩçÊï∞ÊçÆÁöÑ‰ΩéÂÖ´‰ΩçÁõ¥Êé•ËµãÁªôÂÖ´‰ΩçÊï∞ÊçÆ
  78   1          TH0=value>>8;               //Â∞Ü16‰ΩçÊï∞ÊçÆÂè≥Áßª8‰ΩçÔºå‰πüÂ∞±ÊòØÂ∞ÜÈ´ò8‰ΩçÁßªÂà∞‰ΩéÂÖ´‰ΩçÔºåÂÜçËµãÂÄºÁªô8‰ΩçÊï∞Êç
             -Æ
  79   1          TR0 = 1;
  80   1      }
  81          
  82          /***********************************************************
  83          * Âêç    Áß∞Ôºö Timer0_isr() interrupt 1 using 1
  84          * Âäü    ËÉΩÔºö Êó∂Èíü0‰∏≠Êñ≠Â§ÑÁêÜ
  85          * ÂÖ•Âè£ÂèÇÊï∞Ôºö Êó†
  86          * Âá∫Âè£ÂèÇÊï∞Ôºö Êó†
  87          * ËØ¥    ÊòéÔºö
  88          /**********************************************************/
  89          void Timer0_isr(void) interrupt 1 using 1
  90          {
  91   1          static unsigned char i = 1; //ÈùôÊÄÅÂèòÈáèÔºöÊØèÊ¨°Ë∞ÉÁî®ÂáΩÊï∞Êó∂‰øùÊåÅ‰∏ä‰∏ÄÊ¨°ÊâÄËµãÁöÑÂÄºÔºå
  92   1          //Ë∑üÂÖ®Â±ÄÂèòÈáèÁ±ª‰ººÔºå‰∏çÂêåÊòØÂÆÉÂè™ËÉΩÁî®‰∫éÊ≠§ÂáΩÊï∞ÂÜÖÈÉ®
  93   1          switch(i)
  94   1          {
  95   2          case 1:
  96   2              Car_Servo = 1;  //PWMÊéßÂà∂ËÑöÈ´òÁîµÂπ≥
  97   2              //ÁªôÂÆöÊó∂Âô®0ËµãÂÄºÔºåËÆ°Êï∞Pwm0Duty‰∏™ËÑâÂÜ≤Âêé‰∫ßÁîü‰∏≠Êñ≠Ôºå‰∏ãÊ¨°‰∏≠Êñ≠‰ºöËøõÂÖ•‰∏ã‰∏Ä‰∏™cas
             -eËØ≠Âè•
  98   2              Timer0Value(Servo0PwmDuty);
  99   2              break;
 100   2          case 2:
 101   2              Car_Servo = 0;  //PWMÊéßÂà∂ËÑö‰ΩéÁîµÂπ≥
 102   2              //È´òËÑâÂÜ≤ÁªìÊùüÂêéÂâ©‰∏ãÁöÑÊó∂Èó¥(20000-Pwm0Duty)ÂÖ®ÊòØ‰ΩéÁîµÂπ≥‰∫ÜÔºåPwm0Duty + (20000-Pwm0Duty
             -) = 20000‰∏™ËÑâÂÜ≤Ê≠£Â•Ω‰∏∫‰∏Ä‰∏™Âë®Êúü20ÊØ´Áßí
 103   2              Timer0Value(20000-Servo0PwmDuty);
 104   2              i = 0;
 105   2              break;
 106   2          }
 107   1          i++;
C51 COMPILER V9.54   MAIN                                                                  09/26/2022 20:05:51 PAGE 3   

 108   1      }
 109          
 110          sbit  Car_Motor_A1=P3^2;         // ÁîµÊú∫PWMÊéßÂà∂Á´Ø
 111          sbit  Car_Motor_EN1=P3^3;        //ÁîµÊú∫‰ΩøËÉΩÊéßÂà∂Á´Ø
 112          sbit  Car_Motor_B1=P3^4;         // ÁîµÊú∫ÊéßÂà∂Á´Ø
 113          
 114          unsigned int Motor0PwmDuty=2750;                  //ÂàùÂßãÂç†Á©∫ÊØî‰∏∫3000:7000
 115          /***********************************************************
 116          * Âêç    Áß∞ÔºöTimer1Value(unsigned int pwm)
 117          * Âäü    ËÉΩÔºöÁªôÂÆöÊó∂Âô®1ËÆ°Êï∞Âô®ËµãÂÄº‰∫ßÁîüÂÆöÊó∂‰∏≠Êñ≠
 118          * ÂÖ•Âè£ÂèÇÊï∞Ôºöpwm            ÊéßÂà∂ÁîµÊú∫ÁöÑPWMËÑâÂÜ≤ÂÆΩÂ∫¶ÂÄºÔºàËåÉÂõ¥Ôºö0~10000Ôºâ
 119          * Âá∫Âè£ÂèÇÊï∞ÔºöÊó†
 120          * ËØ¥    ÊòéÔºö12MÊô∂ÊåØÔºå12ÂàÜÈ¢ëÔºåÊâÄ‰ª•ËÆ°Êï∞Âô®ÊØèÈÄíÂ¢û‰∏Ä‰∏™Êï∞Â∞±ÊòØ1ÂæÆÁßíÔºåÂÆåÂÖ®Êª°Ë∂≥ËàµÊú∫Ê
             -éßÂà∂ÁöÑÁ≤æÂ∫¶Ë¶ÅÊ±Ç
 121                                  Âõ†‰∏∫ÂÆöÊó∂Âô®ÊòØTH0ÔºåTL0ÈÉΩË¶ÅÂÖ®ÈÉ®ËÆ°Êï∞Âà∞0xFFÂêéÂú®ËÆ°1‰∏™Êï∞Â∞±‰ºö‰∫ßÁîü‰∏≠Êñ≠ÔºåÊâÄ‰ª•Ë¶ÅÊÉ≥‰∫
             -ßÁîü
 122                                  pwmÊØ´ÁßíÁöÑ‰∏≠Êñ≠ÔºåÈÇ£‰πàTH0ÔºåTL0Â∞±Â∫îËØ•ËµãÂÄºÔºà0xFFFF-pwmÔºâ     ‰ªéËøô‰∏™ÂÄºÂºÄÂßãËÆ°Êï∞‰∫ßÁîüÂÆöÊó
             -∂‰∏≠Êñ≠
 123          /**********************************************************/
 124          void Timer1Value(unsigned int pwm)
 125          {
 126   1          unsigned int value;
 127   1          value=0xffff-pwm;
 128   1          TR1 = 0;
 129   1          TL1=value;                  //16‰ΩçÊï∞ÊçÆÁªô8‰ΩçÊï∞ÊçÆËµãÂÄºÈªòËÆ§Â∞Ü16‰ΩçÊï∞ÊçÆÁöÑ‰ΩéÂÖ´‰ΩçÁõ¥Êé•ËµãÁªôÂÖ´‰ΩçÊï∞ÊçÆ
 130   1          TH1=value>>8;               //Â∞Ü16‰ΩçÊï∞ÊçÆÂè≥Áßª8‰ΩçÔºå‰πüÂ∞±ÊòØÂ∞ÜÈ´ò8‰ΩçÁßªÂà∞‰ΩéÂÖ´‰ΩçÔºåÂÜçËµãÂÄºÁªô8‰ΩçÊï∞Êç
             -Æ
 131   1          TR1 = 1;
 132   1      }
 133          
 134          /***********************************************************
 135          * Âêç    Áß∞ÔºöTimer1Init
 136          * Âäü    ËÉΩÔºöÁîµÊú∫Êó∂Èíü1ÂàùÂßãÂåñ
 137          * ÂÖ•Âè£ÂèÇÊï∞ÔºöÊó†
 138          * Âá∫Âè£ÂèÇÊï∞ÔºöÊó†
 139          * ËØ¥    ÊòéÔºö10ms‰∏ÄÂë®Êúü
 140          /**********************************************************/
 141          void Timer1Init(void)           //10ÊØ´Áßí@12.000MHz
 142          {
 143   1          TMOD &= 0x0F;               //ËÆæÁΩÆÂÆöÊó∂Âô®Ê®°Âºè
 144   1          TMOD |= 0x10;               //ËÆæÁΩÆÂÆöÊó∂Âô®Ê®°Âºè
 145   1          TL1 = 0xF0;                 //ËÆæÁΩÆÂÆöÊó∂ÂàùÂÄº
 146   1          TH1 = 0xD8;                 //ËÆæÁΩÆÂÆöÊó∂ÂàùÂÄº
 147   1          TF1 = 0;                    //Ê∏ÖÈô§TF1Ê†áÂøó
 148   1          TR1 = 1;                    //ÂÆöÊó∂Âô®1ÂºÄÂßãËÆ°Êó∂
 149   1          ET1 = 1;                    //ÂºÄÂÆöÊó∂Âô®1‰∏≠Êñ≠
 150   1          EA = 1;             //ÂºÄÊÄª‰∏≠Êñ≠
 151   1      }
 152          
 153          /***********************************************************
 154          * Âêç    Áß∞ÔºöCar_Motor_Init()
 155          * Âäü    ËÉΩÔºöÁîµÊú∫ÂàùÂßãÂåñ
 156          * ÂÖ•Âè£ÂèÇÊï∞ÔºöÊó†
 157          * Âá∫Âè£ÂèÇÊï∞ÔºöÊó†
 158          * ËØ¥    ÊòéÔºö10ms‰∏ÄÂë®Êúü
 159          /**********************************************************/
 160          void Car_Motor_Init()
 161          {
 162   1          Car_Motor_EN1=1;     //ÁîµÊú∫‰ΩøËÉΩÊéßÂà∂Á´Ø
 163   1          Car_Motor_B1=0;      // ÁîµÊú∫ÊéßÂà∂Á´Ø‰∏ÄÁ´Ø‰∏∫‰Ωé
 164   1          Car_Motor_A1=0;      // ÁîµÊú∫PWMÊéßÂà∂Á´Ø‰∏ÄÁ´Ø‰∏∫‰Ωé
 165   1          Timer1Init();       //ÁîµÊú∫ÂÆöÊó∂Âô®ÂàùÂßãÂåñ
C51 COMPILER V9.54   MAIN                                                                  09/26/2022 20:05:51 PAGE 4   

 166   1      }
 167          /***********************************************************
 168          * Âêç    Áß∞Ôºö Timer1_isr() interrupt 3 using 3
 169          * Âäü    ËÉΩÔºö Êó∂Èíü0‰∏≠Êñ≠Â§ÑÁêÜ
 170          * ÂÖ•Âè£ÂèÇÊï∞Ôºö Êó†
 171          * Âá∫Âè£ÂèÇÊï∞Ôºö Êó†
 172          * ËØ¥    ÊòéÔºö Êó†
 173          /**********************************************************/
 174          void Timer1_isr(void) interrupt 3 using 3
 175          {
 176   1          static unsigned char j = 1; //ÈùôÊÄÅÂèòÈáèÔºöÊØèÊ¨°Ë∞ÉÁî®ÂáΩÊï∞Êó∂‰øùÊåÅ‰∏ä‰∏ÄÊ¨°ÊâÄËµãÁöÑÂÄºÔºå
 177   1          //Ë∑üÂÖ®Â±ÄÂèòÈáèÁ±ª‰ººÔºå‰∏çÂêåÊòØÂÆÉÂè™ËÉΩÁî®‰∫éÊ≠§ÂáΩÊï∞ÂÜÖÈÉ®
 178   1              switch(j)
 179   1              {
 180   2              case 1:
 181   2                  Car_Motor_EN1 = 1;  //PWMÊéßÂà∂ËÑöÈ´òÁîµÂπ≥
 182   2                  //ÁªôÂÆöÊó∂Âô®0ËµãÂÄºÔºåËÆ°Êï∞Pwm0Duty‰∏™ËÑâÂÜ≤Âêé‰∫ßÁîü‰∏≠Êñ≠Ôºå‰∏ãÊ¨°‰∏≠Êñ≠‰ºöËøõÂÖ•‰∏ã‰∏Ä‰∏
             -™caseËØ≠Âè•
 183   2      
 184   2                  Timer1Value(Motor0PwmDuty); //È´òÁîµÂπ≥ÊåÅÁª≠Êó∂Èó¥
 185   2                  break;
 186   2              case 2:
 187   2                  Car_Motor_EN1 = 0;  //PWMÊéßÂà∂ËÑö‰ΩéÁîµÂπ≥
 188   2                  //È´òËÑâÂÜ≤ÁªìÊùüÂêéÂâ©‰∏ãÁöÑÊó∂Èó¥(20000-Pwm0Duty)ÂÖ®ÊòØ‰ΩéÁîµÂπ≥‰∫ÜÔºåPwm0Duty + (20000-Pwm0
             -Duty) = 20000‰∏™ËÑâÂÜ≤Ê≠£Â•Ω‰∏∫‰∏Ä‰∏™Âë®Êúü20ÊØ´Áßí
 189   2                  Timer1Value(10000-Motor0PwmDuty);//‰ΩéÁîµÂπ≥ÊåÅÁª≠Êó∂Èó¥
 190   2                  j = 0;
 191   2                  break;
 192   2              }
 193   1              j++;
 194   1      }
 195          
 196          
 197          void Timer2Init(void)           //1ÊØ´Áßí@12.000MHz
 198          {
 199   1              T2MOD = 0;              //ÂàùÂßãÂåñÊ®°ÂºèÂØÑÂ≠òÂô®
 200   1              T2CON = 0;              //ÂàùÂßãÂåñÊéßÂà∂ÂØÑÂ≠òÂô®
 201   1              TL2 = 0x18;             //ËÆæÁΩÆÂÆöÊó∂ÂàùÂßãÂÄº
 202   1              TH2 = 0xff;             //ËÆæÁΩÆÂÆöÊó∂ÂàùÂßãÂÄº
 203   1              RCAP2L = 0x18;          //ËÆæÁΩÆÂÆöÊó∂ÈáçËΩΩÂÄº
 204   1              RCAP2H = 0xff;          //ËÆæÁΩÆÂÆöÊó∂ÈáçËΩΩÂÄº
 205   1              TR2 = 1;                //ÂÆöÊó∂Âô®2ÂºÄÂßãËÆ°Êó∂
 206   1              PT2=0;
 207   1              ET2=1;
 208   1              EA=1;
 209   1      
 210   1      
 211   1      }
 212          void Car_scan_Init(void)
 213          {
 214   1              Timer2Init();
 215   1      }
 216          /***********************************************************
 217          * Âêç    Áß∞Ôºö Timer1_isr() interrupt 5
 218          * Âäü    ËÉΩÔºö Êó∂Èíü2‰∏≠Êñ≠Â§ÑÁêÜ
 219          * ÂÖ•Âè£ÂèÇÊï∞Ôºö P1
 220          * Âá∫Âè£ÂèÇÊï∞Ôºö Êó†
 221          * ËØ¥    ÊòéÔºö Âà©Áî®ÂÆöÊó∂Âô®2ÔºåÂØπP1Âè£ËøõË°åÈ´òÈÄüÊâ´ÊèèÔºåÊèêÈ´òËàµÊú∫ËΩ¨ÂêëÈÄüÂ∫¶
 222          /**********************************************************/
 223          void Timer2_isr(void)interrupt 5
 224          {
 225   1                      TF2=0;
C51 COMPILER V9.54   MAIN                                                                  09/26/2022 20:05:51 PAGE 5   

 226   1              path=P0;
 227   1                      power=P1;
 228   1                      pow=(~power&0x0f);//‰Ωé4‰ΩçÊòØÈÄüÂ∫¶
 229   1                      pos=((power>>4)&0x0f);//È´ò4‰ΩçÊòØËΩ¨Âêë
 230   1      
 231   1      }
 232          /***********************************************************
 233          * Âêç    Áß∞Ôºöctry()
 234          * Âäü    ËÉΩÔºöËΩ®ÈÅì‰ΩçÁΩÆÁöÑÂà§Êñ≠
 235          * ÂÖ•Âè£ÂèÇÊï∞ÔºöP0 P2^3
 236          * Âá∫Âè£ÂèÇÊï∞ÔºöËæìÂá∫ËΩ®ÈÅìÂèòÈáèpathÔºåËØ•ÂèÇÊï∞‰∏∫ÁéØÂ¢ÉÂèòÈáèÔºåËàµÊú∫ÁöÑ‰∏≠Êñ≠Â§ÑÁêÜ
 237                                  ‰ºöÂõ†‰∏∫pathÁöÑÊîπÂèòËÄåÈÄâÊã©ÂêàÈÄÇÁöÑËßíÂ∫¶
 238          * ËØ¥    ÊòéÔºöi++Â∞±ÊòØÂØπËΩ®ÈÅìÂÅèÁ¶ªÁöÑÁªüËÆ°
 239          /**********************************************************/
 240          sbit AB=P2^3; // ËàµÊú∫ËΩ¨ÂêëÁöÑÊ†áËÆ∞Á´ØÂè£
 241          int Zhuan_Jiao [3]={21,31,45};//ÊúÄÂ§ßËΩ¨ÂêëËßíËÆæÁΩÆÔºàÂ∑¶Âè≥ÂØπÁß∞ÔºåÊâÄ‰ª•Âè™ÈúÄË¶Å‰∏ÄÁªÑÔºå‰æùÊ¨°‰ªéÂ∞
             -èÂèòÂ§ßÔºâ
 242          int ctry(unsigned int parameter)
 243          {
 244   1          if(AB==1)
 245   1          {
 246   2              switch(parameter)
 247   2                      {
 248   3                      case 191:
 249   3                  i=0;
 250   3                  return (1500+(Zhuan_Jiao[2]*11/(pos+1)));
 251   3              case 223:
 252   3                  i=0;
 253   3                  return (1500+(Zhuan_Jiao[1]*11/(pos+1)));
 254   3              case 239:
 255   3                  i=0;
 256   3                  return (1500+(Zhuan_Jiao[0]*11/(pos+1)));
 257   3              case 247:
 258   3                  i=0;
 259   3                  return 1500;//90¬∞
 260   3              case 251:
 261   3                  i=0;
 262   3                  return (1500-(Zhuan_Jiao[0]*11/(pos+1)));
 263   3              case 253:
 264   3                  i=0;
 265   3                  return (1500-(Zhuan_Jiao[1]*11/(pos+1)));
 266   3              case 254:
 267   3                  i=0;
 268   3                  return (1500-(Zhuan_Jiao[2]*11/(pos+1)));//30¬∞
 269   3              case 255:
 270   3                  i++;
 271   3                  if(i>3000)
 272   3                  {
 273   4                  return 1500;//Ê£ÄÊµãÊó†ËΩ®ÈÅìÂ∞±ËÆ©ËΩ¶Â§¥ÂØπÊ≠£Â∏ÆÂä©ÂÄíËΩ¶
 274   4                  }
 275   3              default:
 276   3                  return Servo0PwmDuty;
 277   3                      }
 278   2          }
 279   1          else
 280   1          {
 281   2              switch(parameter)
 282   2                      {
 283   3                      case 254:
 284   3                  i=0;
 285   3                  return (1500+(Zhuan_Jiao[2]*11/(pos+1)));
 286   3              case 253:
C51 COMPILER V9.54   MAIN                                                                  09/26/2022 20:05:51 PAGE 6   

 287   3                  i=0;
 288   3                  return (1500+(Zhuan_Jiao[1]*11/(pos+1)));
 289   3              case 251:
 290   3                  i=0;
 291   3                  return (1500+(Zhuan_Jiao[0]*11/(pos+1)));
 292   3              case 247:
 293   3                  i=0;
 294   3                  return 1500;//90¬∞
 295   3              case 239:
 296   3                  i=0;
 297   3                  return (1500-(Zhuan_Jiao[0]*11/(pos+1)));
 298   3              case 223:
 299   3                  i=0;
 300   3                  return (1500-(Zhuan_Jiao[1]*11/(pos+1)));
 301   3              case 191:
 302   3                  i=0;
 303   3                  return (1500-(Zhuan_Jiao[2]*11/(pos+1)));//30¬∞
 304   3              case 255:
 305   3                  i++;
 306   3                  return 1500;//Ê£ÄÊµãÊó†ËΩ®ÈÅìÂ∞±ËÆ©ËΩ¶Â§¥ÂØπÊ≠£Â∏ÆÂä©ÂÄíËΩ¶
 307   3              default:
 308   3                  return Servo0PwmDuty;
 309   3                      }
 310   2          }
 311   1      
 312   1      }
 313          sbit LEDA=P2^1;//ÂàπËΩ¶ÁÅØÁöÑIOÊé•Âè£
 314          sbit LEDB=P2^2;//ÂàπËΩ¶ÁÅØÁöÑIOÊé•Âè£
 315          /***********************************************************
 316          * Âêç    Áß∞Ôºödaoche()
 317          * Âäü    ËÉΩÔºöÂÄíËΩ¶ÊåáÁ§∫‰ª•ÂèäÂØπÂÄíËΩ¶Áä∂ÊÄÅÁöÑÊ∏ÖÈõ∂
 318          * ÂÖ•Âè£ÂèÇÊï∞ÔºöÊó†
 319          * Âá∫Âè£ÂèÇÊï∞ÔºöÊó†
 320          * ËØ¥    ÊòéÔºöÊ£ÄÊµãÂà∞‰∏¢Â§±ÂêéÂèàÊâßË°å10000‰∏™ÂëΩ‰ª§Âë®ÊúüÁöÑÂÄíËΩ¶ÔºåÊó†ËÆ∫ÊòØÂê¶
 321                                  ÈáçÊñ∞ÂØªÊâæÂà∞Ë∑ØÂæÑÈÉΩÂâçËøõ‰∏ÄÊÆµÔºåÈáçÊñ∞Â∑°Á∫øÂèçÂ§çÊâ´ÊèèÔºå‰øùËØÅÊàêÂäüÁéá
 322          /**********************************************************/
 323          void daoche()
 324          {
 325   1          if(i>3000)          //ËΩ®ÈÅì‰∏¢Â§±Èò≤ÊäñÔºåÂºÄÂßãÂÄíËΩ¶
 326   1          {
 327   2                      LEDA = 1;
 328   2              LEDB = 0;
 329   2                      Car_Motor_B1=0;  
 330   2                      Car_Motor_A1=1;
 331   2                      if(i==2001)
 332   2                      {
 333   3                              Motor0PwmDuty=100*(pow);
 334   3                              Delay(5);
 335   3                              Motor0PwmDuty=200*(pow);
 336   3                              Delay(8);
 337   3                              Motor0PwmDuty=300*(pow);
 338   3                      }
 339   2              if(i>20000)//ÂÄíËΩ¶ÊåÅÁª≠ÁöÑÊ£ÄÊµãÂë®Êúü
 340   2                      {
 341   3                  i=0;        //‰∏¢Â§±Ê†áËÆ∞Ê∏ÖÈô§
 342   3              }
 343   2                      
 344   2          }
 345   1      
 346   1          else                        //Ê≠£Â∏∏ÂâçËøõ
 347   1                      
 348   1          {   
C51 COMPILER V9.54   MAIN                                                                  09/26/2022 20:05:51 PAGE 7   

 349   2                      Car_Motor_B1=1;  
 350   2                      Car_Motor_A1=0;
 351   2                      LEDA = 0;
 352   2              LEDB = 0;
 353   2                      if(i==0)        
 354   2                      {
 355   3                              Motor0PwmDuty=100*(pow);//ÁºìÊÖ¢ÁöÑËΩØÂêØÂä®ÔºåÈò≤Ê≠¢ÊâìÊªë
 356   3                              Delay(5);
 357   3                              Motor0PwmDuty=200*(pow);
 358   3                              Delay(5);
 359   3                              Motor0PwmDuty=300*(pow);
 360   3                      }
 361   2                      Motor0PwmDuty=300*(pow);
 362   2          }
 363   1      }
 364          void main()
 365          {
 366   1              Car_scan_Init();
 367   1          Car_Servo_Init();
 368   1          Car_Motor_Init();
 369   1      
 370   1          while(1)
 371   1          {
 372   2              Servo0PwmDuty=ctry(path);
 373   2              daoche();
 374   2          }
 375   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    776    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     22       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
